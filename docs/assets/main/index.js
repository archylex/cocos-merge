System.register("chunks:///_virtual/DirectionEnum.ts",["cc"],(function(e){"use strict";var n,c;return{setters:[function(e){n=e.cclegacy,c=e.Vec2}],execute:function(){n._RF.push({},"437a1zlLopA3rVLhJNZ/ceO","DirectionEnum",void 0);e("DirectionEnum",[new c(1,0),new c(1,1),new c(0,1),new c(-1,1),new c(-1,0),new c(-1,-1),new c(0,-1),new c(1,-1)]);n._RF.pop()}}}));

System.register("chunks:///_virtual/Item.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./DropEvent.ts"],(function(e){"use strict";var t,n,o,i,r,s,l,c,u,a,p,d,h;return{setters:[function(e){t=e.cclegacy,n=e._decorator,o=e.Prefab,i=e.Vec2,r=e.Node,s=e.instantiate,l=e.Component},function(e){c=e.applyDecoratedDescriptor,u=e.inheritsLoose,a=e.defineProperty,p=e.assertThisInitialized,d=e.initializerDefineProperty},function(e){h=e.DropEvent}],execute:function(){var v,f,y,g,m;t._RF.push({},"69155HaEMFAl4zb90DTKLhc","Item",void 0);var D=n.ccclass,P=n.property;e("Item",(v=D("Item"),f=P({type:o}),v((m=c((g=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return t=e.call.apply(e,[this].concat(o))||this,a(p(t),"position",new i),a(p(t),"row",null),a(p(t),"column",null),a(p(t),"sign",null),a(p(t),"level",0),a(p(t),"currentNode",null),a(p(t),"mouseDown",!1),d(p(t),"levelPrefabs",m,p(t)),t}u(t,e);var n=t.prototype;return n.start=function(){var e=this;this.node.on(r.EventType.TOUCH_START,(function(t){e.mouseDown=!0}),this),this.node.on(r.EventType.TOUCH_MOVE,(function(t){if(e.mouseDown){var n=t.getUIDelta(),o=e.node.getPosition().x+n.x,i=e.node.getPosition().y+n.y;e.node.setPosition(o,i,0)}})),this.node.on(r.EventType.TOUCH_END,(function(t){e.mouseDown=!1,e.node.dispatchEvent(new h("dropped",!0,t.getUILocation(),e.node))})),this.levelUp()},n.setBoardPosition=function(e,t){this.row=e,this.column=t},n.setBoardSign=function(e){this.sign=e},n.levelUp=function(){var e=this.level;this.level++,this.level>this.levelPrefabs.length||(this.currentNode&&this.currentNode.destroy(),this.currentNode=s(this.levelPrefabs[e]),this.node.addChild(this.currentNode))},t}(l)).prototype,"levelPrefabs",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),y=g))||y));t._RF.pop()}}}));

System.register("chunks:///_virtual/DropEvent.ts",["cc","./_rollupPluginModLoBabelHelpers.js"],(function(t){"use strict";var e,n,i,r,o,s;return{setters:[function(t){e=t.cclegacy,n=t.Vec2,i=t.Event},function(t){r=t.inheritsLoose,o=t.defineProperty,s=t.assertThisInitialized}],execute:function(){e._RF.push({},"da5cb3xWYJFvpWdDVI+T3qR","DropEvent",void 0);t("DropEvent",function(t){function e(e,i,r,c){var u;return u=t.call(this,e,i)||this,o(s(u),"position",new n),o(s(u),"item",null),u.position=r,u.item=c,u}return r(e,t),e}(i));e._RF.pop()}}}));

System.register("chunks:///_virtual/CellResultType.ts",["cc"],(function(){"use strict";var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"fe674sTqcdAt789tDJqG7pN","CellResultType",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/Board.ts",["cc","./DirectionEnum.ts","./_rollupPluginModLoBabelHelpers.js","./Item.ts"],(function(t){"use strict";var e,i,r,o,n,s,a,l,h,u,c,m,d,f,p;return{setters:[function(t){e=t.cclegacy,i=t._decorator,r=t.Prefab,o=t.instantiate,n=t.UITransform,s=t.Vec3,a=t.Vec2,l=t.Component},function(t){h=t.DirectionEnum},function(t){u=t.applyDecoratedDescriptor,c=t.inheritsLoose,m=t.defineProperty,d=t.assertThisInitialized,f=t.initializerDefineProperty},function(t){p=t.Item}],execute:function(){var g,y,w,b,v,P,B,x,C,R,D,z,A;e._RF.push({},"fed87c7KXBC1oitrS3JIDwK","Board",void 0);var E=i.ccclass,I=i.property;t("Board",(g=E("Board"),y=I(),w=I(),b=I(),v=I({type:r}),P=I({type:r}),g((C=u((x=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,m(d(e),"board",[]),m(d(e),"gameBoard",[]),m(d(e),"items",[]),f(d(e),"row",C,d(e)),f(d(e),"column",R,d(e)),f(d(e),"gap",D,d(e)),f(d(e),"cellPrefab",z,d(e)),f(d(e),"itemsPrefab",A,d(e)),e}c(e,t);var i=e.prototype;return i.start=function(){this.createBoard(),this.createRandomItems(),this.node.on("dropped",this.onDrop,this)},i.createBoard=function(){this.board=new Array(this.row),this.gameBoard=new Array(this.row);for(var t=0;t<this.row;t++){this.board[t]=new Array(this.column),this.gameBoard[t]=new Array(this.column).fill(0);for(var e=0;e<this.column;e++){var i=o(this.cellPrefab),r=i.getComponent(n),s=r.width,a=r.height,l=-this.column*(s/2+this.gap)/this.column,h=-this.row*(a/2+this.gap)/this.row,u=l+e*(s+2*this.gap),c=h+t*(a+2*this.gap);i.setPosition(u,c,0),i.name="Cell-"+t+","+e,this.node.addChild(i),this.board[t][e]=i}}},i.createRandomItems=function(){for(var t=this.getRandomNumbers(),e=0;e<t.length;e++){var i=e!==t.length-1?0:1,r=t[e],n=Math.floor(r/this.column),s=r-n*this.column;this.gameBoard[n][s]=i+1;var a=this.board[n][s].getPosition(),l=o(this.itemsPrefab[i]);l.setPosition(a);var h=l.getComponent(p);h.setBoardPosition(n,s),h.sign=i+1,this.node.addChild(l),this.items.push(h)}},i.getRandomNumbers=function(){for(var t=new Array(this.row*this.column).fill(0).map((function(t,e){return e})),e=[],i=0;i<t.length;i++){var r=Math.floor(Math.random()*t.length);e.push(t.splice(r,1))}return e},i.onDrop=function(t){var e=this.node.parent.getComponent(n).convertToNodeSpaceAR(new s(t.position.x,t.position.y,0)),i=t.item.getComponent(p),r=this.getSelectedCell(e,i.sign),o=this.board[i.row][i.column].getPosition();if(r){var a=this.items.filter((function(t){return t.row===r.row&&t.column===r.column}))[0];if(a==i)return void t.item.setPosition(o);if(r.similar&&(a.node.destroy(),i.levelUp(),this.items=this.items.filter((function(t){return t!=a}))),!r.similar&&!r.empty){var l=this.getFirstEmptyCell(a.row,a.column,i),h=this.board[l.y][l.x];a.node.setPosition(h.getPosition()),this.gameBoard[l.y][l.x]=a.sign,a.setBoardPosition(l.y,l.x)}var u=this.board[r.row][r.column];i.node.setPosition(u.getPosition()),(r.empty||r.similar)&&(this.gameBoard[i.row][i.column]=0),this.gameBoard[r.row][r.column]=i.sign,i.setBoardPosition(r.row,r.column)}else t.item.setPosition(o)},i.getSelectedCell=function(t,e){for(var i=0;i<this.row;i++)for(var r=0;r<this.column;r++){var o=this.board[i][r],s=o.getPosition(),a=o.getComponent(n),l=a.width,h=a.height;if(t.x>=s.x-l/2&&t.x<=s.x+l/2&&t.y>=s.y-h/2&&t.y<=s.y+h/2)return{row:i,column:r,similar:this.gameBoard[i][r]===e,empty:0===this.gameBoard[i][r]}}return null},i.getFirstEmptyCell=function(t,e,i){void 0===i&&(i=null),null!==i&&(this.gameBoard[i.row][i.column]=0);var r=[],o=[],n=!0;for(r.push(new a(e,t));r.length>0;){var s=r.pop();if(n)n=!1;else if(0===this.gameBoard[s.y][s.x])return new a(s.x,s.y);o.push(s),this.getNeighbors(s,o,r)}return new a(i.column,i.row)},i.checkExistPos=function(t,e){for(var i=0;i<t.length;i++)if(t[i].y===e.y&&t[i].x===e.x)return!0;return!1},i.checkRangeBoard=function(t,e){return t>=0&&t<this.row&&e>=0&&e<this.column},i.getNeighbors=function(t,e,i){for(var r=0;r<h.length;r++){var o=t.y+h[r].y,n=t.x+h[r].x;if(this.checkRangeBoard(o,n)){var s=new a(n,o);this.checkExistPos(e,s)||this.checkExistPos(i,s)||0===this.gameBoard[s.y][s.x]&&i.push(s)}}},e}(l)).prototype,"row",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),R=u(x.prototype,"column",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),D=u(x.prototype,"gap",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),z=u(x.prototype,"cellPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=u(x.prototype,"itemsPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=x))||B));e._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./DirectionEnum.ts","./DropEvent.ts","./Item.ts","./CellResultType.ts","./Board.ts"],(function(){"use strict";return{setters:[null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});